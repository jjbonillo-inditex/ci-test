name: QA Approval Recheck

on:
  pull_request_review:
    types: [ submitted, dismissed ]

permissions:
  actions: write
  workflows: write
  pull_requests: read

jobs:
  qa-request:
    runs-on: ubuntu-latest
    needs: execute
    steps:
      - name: Recheck QA Approval
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ðŸ’¬ Commenting '/qa-check' on PR..."
          
          PR_NUMBER=${{ github.event.pull_request.number }}
          REPO=${{ github.repository }}
          
          curl -s -X POST \
              -H "Accept: application/vnd.github+json" \
              -H "Authorization: Bearer $GH_TOKEN" \
              -H "X-GitHub-Api-Version: 2022-11-28" \
              "https://api.github.com/repos/$REPO/issues/$PR_NUMBER/comments" \
              -d '{"body":"/qa-check"}'
    
          cho "âœ… Comment '/qa-check' added to PR #$PR_NUMBER"
